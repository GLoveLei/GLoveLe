<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>文心一言百度人工智能AI大数据模型文心一言Python3.10接入</title><meta name="description" content="Choose what you love"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/beautiful.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
“文心”取自《文心雕龙》一书的开篇，作者刘勰在书中引述了一个古代典故：春秋时期，鲁国有一位名叫孔文子的大夫，他在学问上非常有造诣，但是他的儿子却不学无术，孔文子非常痛心。
一天，孔文子在山上遇到了一位神仙，神仙告诉他：“你的儿子之所以不学无术，是因为你没有给他灌输文心，让他懂得文学的魅力和意义。”孔文子听后深受启发，回家后开始给儿子灌输文学知识，儿子也逐渐对学问产生了兴趣，最终成为了一位有学问的人。因此，刘勰在书中将“文心”解释为“灌输文学知识的心灵”之意。
百度以“文心”命名自己的AI产品线，可见其对自己的中文处理能力是极为自信的，ERNIE3.0对标ChatGPT3.5/4.0，ERNIE-ViLG对标Stable-Diffusion，文心PLATO则可以理解为ChatGPT的embedding，可谓.."><script src="//unpkg.com/valine/dist/Valine.min.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Lei Gao blog" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Lei Gao's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">文心一言百度人工智能AI大数据模型文心一言Python3.10接入</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E5%BF%83%E4%B8%80%E8%A8%80SDK%E5%BC%95%E5%85%A5"><span class="toc-text">文心一言SDK引入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E5%BF%83%E4%B8%80%E8%A8%80API%E8%B0%83%E7%94%A8"><span class="toc-text">文心一言API调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></div><div class="column is-9"><header class="my-4"></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">文心一言百度人工智能AI大数据模型文心一言Python3.10接入</h1><time class="has-text-grey" datetime="2023-04-10T09:43:53.000Z">2023-04-10</time><article class="mt-2 post-content"><p><img src="/images/ai-01.png" alt="cover"></p>
<p>“文心”取自《文心雕龙》一书的开篇，作者刘勰在书中引述了一个古代典故：春秋时期，鲁国有一位名叫孔文子的大夫，他在学问上非常有造诣，但是他的儿子却不学无术，孔文子非常痛心。</p>
<p>一天，孔文子在山上遇到了一位神仙，神仙告诉他：“你的儿子之所以不学无术，是因为你没有给他灌输文心，让他懂得文学的魅力和意义。”孔文子听后深受启发，回家后开始给儿子灌输文学知识，儿子也逐渐对学问产生了兴趣，最终成为了一位有学问的人。因此，刘勰在书中将“文心”解释为“灌输文学知识的心灵”之意。</p>
<p>百度以“文心”命名自己的AI产品线，可见其对自己的中文处理能力是极为自信的，ERNIE3.0对标ChatGPT3.5/4.0，ERNIE-ViLG对标Stable-Diffusion，文心PLATO则可以理解为ChatGPT的embedding，可谓是野心勃勃。</p>
<h3 id="文心一言SDK引入"><a href="#文心一言SDK引入" class="headerlink" title="文心一言SDK引入"></a>文心一言SDK引入</h3><p>百度目前已经开源文心一言的sdk工具包：</p>
<pre><code class="bash">pip3 install --upgrade wenxin-api</code></pre>
<p>和百度云产品线一样，安装好以后，需要去文心一言官网获取appkey和appsecret</p>
<p><img src="/images/wenxin.png" alt="cover"></p>
<p> 随后编写请求逻辑：</p>
<pre><code class="python">import wenxin_api 
from wenxin_api.tasks.free_qa import FreeQA
wenxin_api.ak = &quot;your ak&quot; #输入您的API Key
wenxin_api.sk = &quot;your sk&quot; #输入您的Secret Key
input_dict = &#123;
    &quot;text&quot;: &quot;问题：你好！\n回答：&quot;,
    &quot;seq_len&quot;: 512,
    &quot;topp&quot;: 0.5,
    &quot;penalty_score&quot;: 1.2,
    &quot;min_dec_len&quot;: 2,
    &quot;min_dec_penalty_text&quot;: &quot;。?：！[&lt;S&gt;]&quot;,
    &quot;is_unidirectional&quot;: 0,
    &quot;task_prompt&quot;: &quot;qa&quot;,
    &quot;mask_type&quot;: &quot;paragraph&quot;
&#125;
requests = FreeQA.create(**input_dict)
print(requests)
</code></pre>
<pre><code class="text">&#123;
  &quot;code&quot;: 0,
  &quot;msg&quot;: &quot;success&quot;,
  &quot;data&quot;: &#123;
    &quot;result&quot;: &quot;你好！我是百度研发的知识增强大语言模型，能够与人对话互动，回答问题，协助创作，高效便捷地帮助你解决学习和工作中的问题。&quot;,
    &quot;createTime&quot;: &quot;2023-03-16 16:02:10&quot;,
    &quot;requestId&quot;: &quot;71a6efb46acbd64394374f44579a01eb&quot;,
    &quot;text&quot;: &quot;天为什么这么蓝&quot;,
    &quot;taskId&quot;: 1000000,
    &quot;status&quot;: 1 # 0表示生成中，1表示生成成功
  &#125;
&#125;</code></pre>
<p>请求的参数含义请参照官方文档：</p>
<p><a target="_blank" rel="noopener" href="https://wenxin.baidu.com/plato">https://wenxin.baidu.com/plato</a></p>
<p>这里需要注意的是，虽然参数支持async异步，但那不是指请求的异步方式返回，换句话说，文心模型返回还是需要等待的，并不是ChatGPT那种流式返回模式。</p>
<h3 id="文心一言API调用"><a href="#文心一言API调用" class="headerlink" title="文心一言API调用"></a>文心一言API调用</h3><p>文心一言SDK的功能有限，也不支持异步请求调用，如果需要定制化或者使用别的语言请求文心一言，需要提前发起Http请求获取token，这里我们使用异步请求库httpx:</p>
<pre><code class="bash">pip3 install httpx</code></pre>
<p>添加获取token逻辑：</p>
<pre><code class="python">class Winxin:

    def chat(self,text):
        input_dict = &#123;
            &quot;text&quot;: f&quot;问题：&#123;text&#125;\n回答：&quot;,
            &quot;seq_len&quot;: 512,
            &quot;topp&quot;: 0.5,
            &quot;penalty_score&quot;: 1.2,
            &quot;min_dec_len&quot;: 2,
            &quot;min_dec_penalty_text&quot;: &quot;。?：！[&lt;S&gt;]&quot;,
            &quot;is_unidirectional&quot;: 0,
            &quot;task_prompt&quot;: &quot;qa&quot;,
            &quot;mask_type&quot;: &quot;paragraph&quot;
        &#125;
        rst = FreeQA.create(**input_dict)
        print(rst)

    async def get_token(self):

        headers = &#123;&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;&#125;

        async with httpx.AsyncClient() as client:
            resp = await client.post(f&quot;https://wenxin.baidu.com/moduleApi/portal/api/oauth/token?grant_type=client_credentials&amp;client_id=&#123;wenxin_api.ak&#125;&amp;client_secret=&#123;wenxin_api.sk&#125;&quot;,headers=headers)
            result = resp.json()
            print(result)</code></pre>
<p> 异步调用文心一言接口的token:</p>
<pre><code class="python">if __name__ == &#39;__main__&#39;:

    wx = Winxin()
    asyncio.run(wx.get_token())</code></pre>
<p>程序返回：</p>
<pre><code class="text">&#123;&#39;code&#39;: 0, &#39;msg&#39;: &#39;success&#39;, &#39;data&#39;: &#39;24.3f6a63545345ae6588ea86a353.86400000.1679123673218.92a99f8955c6f9ab2c438a5f31b5d73b-173001&#39;&#125;</code></pre>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>产品力而言，ChatGPT珠玉在前，文心一言还有很长的路需要走。ChatGPT虽然是一座遥不可及的高峰，但是其他公司也无须放弃人工智能领域的研究，毕竟作为最老牌的中文搜索引擎，百度浸润几十年的中文处理能力，还是无人能出其右的。</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/2023/03/16/SchatGPT-4/" title="让ChatGPT直接编写可运行的程序代码(Python3.10实现)"><span class="has-text-weight-semibold">下一页: 让ChatGPT直接编写可运行的程序代码(Python3.10实现)</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/Claudia-theme-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article><article class="mt-6 comment-container" id="vcomments"></article><div id="disqus_thread"></div><article class="mt-6 comment-container" id="disqus"><script>var disqus_config = function () {this.page.url = 'null/2023/04/10/Sai-01/';this.page.identifier = 'null';};</script><script>(function() {var d = document, s = d.createElement('script');s.src = 'https://null.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script><script id="dsq-count-scr" src="//blog-pubgj2togw.disqus.com/count.js" async></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/glovelei"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml"><i class="iconfont icon-rss"></i></a><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Lei Gao 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>